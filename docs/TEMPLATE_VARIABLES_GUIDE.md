# Руководство по подготовке шаблонов с переменными

## Содержание
1. [Синтаксис переменных](#синтаксис-переменных)
2. [Пример договора подряда](#пример-договора-подряда)
3. [Работа с таблицами](#работа-с-таблицами)
4. [Условия и циклы](#условия-и-циклы)
5. [Доступные переменные](#доступные-переменные)

---

## Синтаксис переменных

Переменные в шаблонах обозначаются двойными фигурными скобками: `{{имя_переменной}}`

### Примеры:
```
{{company.name}}          - Название компании
{{client.inn}}            - ИНН клиента
{{project.budget}}        - Бюджет проекта
{{current.date}}          - Текущая дата
```

### Вложенные значения:
```
{{company.name}}          - Название вашей компании
{{company.director}}      - ФИО директора
{{client.contact.name}}   - Имя контактного лица клиента
{{project.manager.name}}  - Имя менеджера проекта
```

---

## Пример договора подряда

### Исходный шаблон (DOCX/TXT)

```
ДОГОВОР ПОДРЯДА № {{contract.number}}

г. Москва                                                    {{contract.date}}


{{company.name}}, именуемое в дальнейшем «ЗАКАЗЧИК», в лице {{company.director}}, 
действующего на основании Устава, с одной стороны, и {{client.name}}, именуемое 
в дальнейшем «ПОДРЯДЧИК», в лице {{client.director}}, действующего на основании 
{{client.basis}}, с другой стороны, вместе именуемые «Стороны», заключили настоящий 
Договор о нижеследующем:


1. ПРЕДМЕТ ДОГОВОРА

1.1. ЗАКАЗЧИК поручает, а ПОДРЯДЧИК принимает на себя обязательство выполнить 
работы по проекту "{{project.name}}" (далее – Работы), а ЗАКАЗЧИК обязуется принять 
и оплатить выполненные работы.

1.2. Срок выполнения работ: с {{project.startDate}} по {{project.endDate}}.

1.3. Место выполнения работ: {{project.address}}.


2. СТОИМОСТЬ РАБОТ И ПОРЯДОК РАСЧЕТОВ

2.1. Общая стоимость работ по настоящему Договору составляет {{contract.amount}} 
({{contract.amountInWords}}) рублей, в том числе НДС {{contract.vat}}%.

2.2. Оплата производится в следующем порядке:
- Аванс в размере {{contract.prepayment}}% в течение {{contract.prepaymentDays}} 
  банковских дней с момента подписания договора;
- Окончательный расчет в течение {{contract.finalPaymentDays}} банковских дней 
  после подписания Акта выполненных работ.


3. ПРАВА И ОБЯЗАННОСТИ СТОРОН

3.1. ЗАКАЗЧИК обязуется:
3.1.1. Предоставить ПОДРЯДЧИКУ всю необходимую документацию и информацию для 
выполнения работ.
3.1.2. Произвести приемку выполненных работ в срок не позднее {{contract.acceptanceDays}} 
рабочих дней.
3.1.3. Своевременно производить оплату выполненных работ.

3.2. ПОДРЯДЧИК обязуется:
3.2.1. Выполнить работы качественно и в установленный срок.
3.2.2. Обеспечить соблюдение требований техники безопасности.
3.2.3. Предоставлять отчеты о ходе выполнения работ по запросу ЗАКАЗЧИКА.


4. ОТВЕТСТВЕННОСТЬ СТОРОН

4.1. За неисполнение или ненадлежащее исполнение обязательств по настоящему 
Договору Стороны несут ответственность в соответствии с действующим законодательством РФ.

4.2. В случае нарушения сроков выполнения работ ПОДРЯДЧИК уплачивает ЗАКАЗЧИКУ 
пени в размере {{contract.penaltyRate}}% от стоимости невыполненных работ за каждый 
день просрочки.


5. СРОК ДЕЙСТВИЯ ДОГОВОРА

5.1. Настоящий Договор вступает в силу с момента его подписания Сторонами и 
действует до {{contract.endDate}}, а в части расчетов – до полного исполнения 
Сторонами своих обязательств.


6. РЕКВИЗИТЫ И ПОДПИСИ СТОРОН

ЗАКАЗЧИК:                                    ПОДРЯДЧИК:

{{company.name}}                             {{client.name}}
ИНН: {{company.inn}}                         ИНН: {{client.inn}}
КПП: {{company.kpp}}                         КПП: {{client.kpp}}
ОГРН: {{company.ogrn}}                       ОГРН: {{client.ogrn}}

Юридический адрес:                           Юридический адрес:
{{company.address}}                          {{client.address}}

Расчетный счет:                              Расчетный счет:
{{company.bankAccount}}                      {{client.bankAccount}}
Банк: {{company.bankName}}                   Банк: {{client.bankName}}
БИК: {{company.bik}}                         БИК: {{client.bik}}
Корр. счет: {{company.corrAccount}}         Корр. счет: {{client.corrAccount}}

Телефон: {{company.phone}}                   Телефон: {{client.phone}}
Email: {{company.email}}                     Email: {{client.email}}


____________________/{{company.director}}/   ____________________/{{client.director}}/

М.П.                                         М.П.
```

---

## Работа с таблицами

### Пример спецификации к договору

```
СПЕЦИФИКАЦИЯ № {{specification.number}}
к Договору подряда № {{contract.number}} от {{contract.date}}


┌────┬──────────────────────────────┬──────┬───────┬─────────┬──────────┐
│ №  │ Наименование работ           │ Ед.  │ Кол-во│  Цена   │  Сумма   │
│п/п │                              │ изм. │       │  (руб.) │  (руб.)  │
├────┼──────────────────────────────┼──────┼───────┼─────────┼──────────┤
{{#items}}
│ {{index}} │ {{name}}               │ {{unit}} │ {{quantity}} │ {{price}} │ {{total}} │
{{/items}}
├────┴──────────────────────────────┴──────┴───────┴─────────┼──────────┤
│                                            ИТОГО без НДС:   │ {{subtotal}} │
│                                            НДС {{vat}}%:    │ {{vatAmount}} │
│                                            ИТОГО с НДС:     │ {{total}} │
└─────────────────────────────────────────────────────────────┴──────────┘

Всего наименований: {{itemsCount}}, на сумму {{total}} ({{totalInWords}}) рублей.


ЗАКАЗЧИК: ____________________/{{company.director}}/    М.П.

ПОДРЯДЧИК: ___________________/{{client.director}}/     М.П.
```

### Как работает цикл `{{#items}}...{{/items}}`:

1. `{{#items}}` - начало цикла
2. Внутри цикла доступны поля каждого элемента: `{{name}}`, `{{price}}`, `{{quantity}}`
3. `{{/items}}` - конец цикла

При генерации система автоматически повторит содержимое для каждого элемента массива.

---

## Условия и циклы

### Условия (если нужно)

```
{{#if project.hasVat}}
в том числе НДС {{contract.vat}}%
{{/if}}

{{#if client.isCompany}}
{{client.name}}, ИНН {{client.inn}}
{{else}}
{{client.fullName}}, паспорт {{client.passport}}
{{/if}}
```

### Циклы для списков

```
Состав работ:
{{#tasks}}
  {{index}}. {{title}} - {{status}}
     Исполнитель: {{assignee}}
     Срок: с {{startDate}} по {{endDate}}
{{/tasks}}
```

### Вложенные циклы

```
{{#projects}}
Проект: {{name}}
  Задачи:
  {{#tasks}}
    - {{title}} ({{status}})
  {{/tasks}}
{{/projects}}
```

---

## Доступные переменные

### 1. Данные компании (вашей)

```json
{
  "company": {
    "name": "ООО \"Электромонтаж\"",
    "inn": "7701234567",
    "kpp": "770101001",
    "ogrn": "1027700123456",
    "director": "Иванов Иван Иванович",
    "accountant": "Петрова Мария Сергеевна",
    "address": "123456, г. Москва, ул. Ленина, д. 1",
    "phone": "+7 (495) 123-45-67",
    "email": "info@electro.ru",
    "bankAccount": "40702810100000000001",
    "bankName": "ПАО Сбербанк",
    "bik": "044525225",
    "corrAccount": "30101810400000000225"
  }
}
```

### 2. Текущие данные

```json
{
  "current": {
    "date": "01.10.2025",
    "year": "2025",
    "month": "Октябрь",
    "day": "01",
    "user": "Иванов И.И."
  }
}
```

### 3. Данные документа

```json
{
  "document": {
    "number": "DOG-2025-001",
    "date": "01.10.2025",
    "type": "Договор подряда"
  }
}
```

### 4. Данные проекта

```json
{
  "project": {
    "id": "proj_123",
    "name": "Электромонтаж офиса",
    "code": "EM-2025-001",
    "description": "Полный комплекс электромонтажных работ",
    "budget": "1000000",
    "budgetInWords": "Один миллион",
    "startDate": "01.10.2025",
    "endDate": "30.11.2025",
    "address": "г. Москва, ул. Пушкина, д. 10",
    "manager": {
      "name": "Сидоров Петр Иванович",
      "phone": "+7 (495) 111-22-33",
      "email": "sidorov@electro.ru"
    },
    "status": "Активный",
    "priority": "Высокий"
  }
}
```

### 5. Данные клиента

```json
{
  "client": {
    "name": "ООО \"Рога и Копыта\"",
    "inn": "7702345678",
    "kpp": "770201001",
    "ogrn": "1027702345678",
    "director": "Петров Петр Петрович",
    "basis": "Устава",
    "address": "123456, г. Москва, ул. Ленина, д. 2",
    "phone": "+7 (495) 222-33-44",
    "email": "info@rogakopyta.ru",
    "bankAccount": "40702810200000000002",
    "bankName": "ПАО ВТБ",
    "bik": "044525187",
    "corrAccount": "30101810700000000187",
    "contact": {
      "name": "Смирнов Алексей",
      "position": "Директор",
      "phone": "+7 (926) 123-45-67",
      "email": "smirnov@rogakopyta.ru"
    }
  }
}
```

### 6. Данные договора

```json
{
  "contract": {
    "number": "DOG-2025-001",
    "date": "01.10.2025",
    "amount": "1000000",
    "amountInWords": "Один миллион",
    "vat": "20",
    "vatAmount": "200000",
    "prepayment": "30",
    "prepaymentDays": "5",
    "finalPaymentDays": "10",
    "acceptanceDays": "5",
    "penaltyRate": "0.1",
    "endDate": "30.11.2025",
    "paymentTerms": "По факту выполнения работ",
    "deliveryTerms": "На объекте Заказчика"
  }
}
```

### 7. Позиции работ/товаров (для таблиц)

```json
{
  "items": [
    {
      "index": "1",
      "name": "Монтаж силового щита",
      "description": "Установка и подключение силового щита ЩС-40",
      "unit": "шт",
      "quantity": "2",
      "price": "50000",
      "total": "100000",
      "code": "EM-001"
    },
    {
      "index": "2",
      "name": "Прокладка кабеля",
      "description": "Прокладка кабеля ВВГнг 3x2.5",
      "unit": "м",
      "quantity": "150",
      "price": "350",
      "total": "52500",
      "code": "EM-002"
    }
  ],
  "subtotal": "850000",
  "vatAmount": "170000",
  "total": "1000000",
  "totalInWords": "Один миллион",
  "itemsCount": "10"
}
```

### 8. Задачи проекта

```json
{
  "tasks": [
    {
      "index": "1",
      "title": "Проектирование",
      "description": "Разработка проектной документации",
      "status": "Завершена",
      "assignee": "Инженер Иванов",
      "startDate": "01.10.2025",
      "endDate": "15.10.2025",
      "progress": "100",
      "hours": "40"
    }
  ]
}
```

### 9. Финансовые данные

```json
{
  "finance": {
    "income": "1000000",
    "expenses": "700000",
    "profit": "300000",
    "margin": "30",
    "planned": "1200000",
    "actual": "1000000",
    "period": {
      "start": "01.10.2025",
      "end": "30.10.2025",
      "month": "Октябрь",
      "quarter": "4 квартал",
      "year": "2025"
    }
  }
}
```

### 10. Данные сотрудника (для HR документов)

```json
{
  "employee": {
    "fullName": "Иванов Иван Иванович",
    "position": "Инженер-электрик",
    "department": "Производственный отдел",
    "salary": "80000",
    "hireDate": "01.10.2025",
    "passportSeries": "4510",
    "passportNumber": "123456",
    "passportIssued": "ОВД Центрального района г. Москвы",
    "passportDate": "01.01.2010",
    "inn": "123456789012",
    "snils": "123-456-789 01",
    "address": "г. Москва, ул. Пушкина, д. 5, кв. 10",
    "phone": "+7 (926) 111-22-33",
    "email": "ivanov@electro.ru"
  }
}
```

---

## Форматирование и функции

### Форматирование дат

```
{{formatDate contract.date "DD.MM.YYYY"}}     → 01.10.2025
{{formatDate contract.date "D MMMM YYYY"}}    → 1 октября 2025
{{formatDate contract.date "DD/MM/YY"}}       → 01/10/25
```

### Форматирование чисел

```
{{formatNumber project.budget}}               → 1 000 000
{{formatCurrency project.budget}}             → 1 000 000 ₽
{{formatNumber project.budget "0,0.00"}}      → 1,000,000.00
```

### Сумма прописью

```
{{numberToWords 1000000}}                     → Один миллион
{{numberToWordsWithCurrency 1000000}}         → Один миллион рублей 00 копеек
```

### Математические операции

```
{{add item.price item.tax}}                   → Сложение
{{multiply item.quantity item.price}}         → Умножение
{{subtract total discount}}                   → Вычитание
{{divide total itemsCount}}                   → Деление
```

---

## Практические советы

### 1. Подготовка шаблона в Word

1. Создайте обычный документ Word
2. Везде, где нужны данные, вставьте переменные: `{{company.name}}`
3. Сохраните как `.docx`
4. Загрузите в Manexa через вкладку "Шаблоны"

### 2. Тестирование шаблона

Перед использованием проверьте:
- Все переменные написаны правильно
- Нет лишних пробелов внутри `{{ }}`
- Циклы правильно открыты и закрыты
- Таблицы корректно отформатированы

### 3. Типичные ошибки

❌ **Неправильно:**
```
{{ company.name }}        (лишние пробелы)
{{companyname}}          (отсутствует точка)
{{company.Name}}         (неправильный регистр)
```

✅ **Правильно:**
```
{{company.name}}
{{client.inn}}
{{project.budget}}
```

---

## Пример минимального договора

Если нужен простой договор для быстрого старта:

```
ДОГОВОР № {{document.number}}

{{current.date}}

Мы, {{company.name}} (Исполнитель) и {{client.name}} (Заказчик), 
заключили настоящий договор о следующем:

1. ПРЕДМЕТ ДОГОВОРА
Исполнитель обязуется выполнить работы по проекту "{{project.name}}", 
а Заказчик обязуется принять и оплатить эти работы.

2. СТОИМОСТЬ
Стоимость работ составляет {{project.budget}} рублей.

3. СРОКИ
Работы выполняются с {{project.startDate}} по {{project.endDate}}.

4. РЕКВИЗИТЫ

Исполнитель:
{{company.name}}
ИНН: {{company.inn}}
Адрес: {{company.address}}

Заказчик:
{{client.name}}
ИНН: {{client.inn}}
Адрес: {{client.address}}


_________________        _________________
Исполнитель              Заказчик
```

---

## Что дальше?

1. Подготовьте ваш шаблон договора в Word/Excel
2. Добавьте переменные в нужных местах
3. Загрузите шаблон в Manexa
4. При создании документа система автоматически заполнит все данные
5. Получите готовый документ для подписания

Если нужна помощь с конкретным шаблоном - просто покажите его, и я помогу расставить правильные переменные!

